webpackJsonp([15],{"5tXg":function(s,t,a){s.exports=a("dqHb")},dqHb:function(s,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={render:function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("h2",{attrs:{id:"call、apply、bind简单实现"}},[s._v("call、apply、bind简单实现")]),s._v(" "),a("div",{staticClass:"aside-menu"},[a("div",{directives:[{name:"toggle",rawName:"v-toggle"}],staticClass:"aside-menu-tit"},[s._v("menu")]),s._v(" "),s._m(0)]),a("b",{staticClass:"update-time"},[s._v(s._s(s._f("formatTime")(1541691883074)))]),a("b",{staticClass:"type"},[s._v("js")]),s._v(" "),a("b",{staticClass:"kw"},[s._v("call实现")]),s._v(" "),a("b",{staticClass:"kw"},[s._v("apply实现")]),s._v(" "),a("b",{staticClass:"kw"},[s._v("bind实现")]),s._v(" "),a("h3",{attrs:{id:"bind实现"}},[s._v("bind实现")]),s._v(" "),s._m(1),s._v(" "),s._m(2),s._v(" "),s._m(3),s._v(" "),s._m(4),s._v(" "),a("h3",{attrs:{id:"call实现"}},[s._v("call实现")]),s._v(" "),s._m(5),s._v(" "),s._m(6),s._v(" "),a("p",[s._v("同样是作为原型方法，需要将参数回传")]),s._v(" "),s._m(7),s._v(" "),s._m(8),s._v(" "),a("h3",{attrs:{id:"拓展"}},[s._v("拓展")]),s._v(" "),a("p",[s._v("由于数组的 concat 方法会返回新数组，但是我们经常希望直接更改原数组，所以只能再次赋值")]),s._v(" "),s._m(9),s._v(" "),a("p",[s._v("模拟 new 实现。我们知道 new 操作是分四步，创建一个对象，创建[[prototype]]链接，this 指向这个对象，没有返回则返回这个对象")]),s._v(" "),s._m(10),s._v(" "),a("h3",{attrs:{id:"拓展阅读"}},[s._v("拓展阅读")]),s._v(" "),s._m(11),s._v(" "),s._m(12)])},staticRenderFns:[function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"aside-menu-con"},[t("a",{staticClass:"level-3 aside-menu-item",attrs:{href:"#bind实现"}},[this._v("bind实现")]),t("a",{staticClass:"level-3 aside-menu-item",attrs:{href:"#call实现"}},[this._v("call实现")]),t("a",{staticClass:"level-3 aside-menu-item",attrs:{href:"#拓展"}},[this._v("拓展")]),t("a",{staticClass:"level-3 aside-menu-item",attrs:{href:"#拓展阅读"}},[this._v("拓展阅读")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("首先看 "),t("code",{pre:!0},[this._v("bind")]),this._v(" 实现，基于 "),t("code",{pre:!0},[this._v("call")]),this._v(" 或 "),t("code",{pre:!0},[this._v("apply")]),this._v(" 实现这个也是最简单的")])},function(){var s=this.$createElement,t=this._self._c||s;return t("pre",{pre:!0},[t("code",{attrs:{"v-pre":"",class:"language-js"}},[this._v("fn.bind(obj, args)\n")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("即 "),t("code",{pre:!0},[this._v("function")]),this._v(" 原型上具备 "),t("code",{pre:!0},[this._v("bind")]),this._v(" 方法，并将第一个参数作为执行者，后续参数作为实参传入，注意将函数的返回返回")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{attrs:{"v-pre":"",class:"language-js"}},[a("span",{attrs:{class:"hljs-built_in"}},[s._v("Function")]),s._v(".prototype.myBind = "),a("span",{attrs:{class:"hljs-function"}},[a("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{attrs:{class:"hljs-params"}},[s._v("obj")]),s._v(") ")]),s._v("{\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" arg = "),a("span",{attrs:{class:"hljs-built_in"}},[s._v("arguments")]),s._v(";\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{attrs:{class:"hljs-function"}},[a("span",{attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".apply(obj || "),a("span",{attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(", "),a("span",{attrs:{class:"hljs-built_in"}},[s._v("Array")]),s._v(".prototype.slice.call(arg, "),a("span",{attrs:{class:"hljs-number"}},[s._v("1")]),s._v("));\n}\n"),a("span",{attrs:{class:"hljs-comment"}},[s._v("// test")]),s._v("\n"),a("span",{attrs:{class:"hljs-function"}},[a("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{attrs:{class:"hljs-title"}},[s._v("test")]),s._v("("),a("span",{attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n  "),a("span",{attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{attrs:{class:"hljs-built_in"}},[s._v("arguments")]),s._v(");\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(";\n}\n\ntest.bind("),a("span",{attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("3")]),s._v(")();\ntest.myBind("),a("span",{attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("3")]),s._v(")();\n")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("blockquote",[t("p",[this._v("从底层上来讲，其实 "),t("code",{pre:!0},[this._v("call")]),this._v(" 相对于 "),t("code",{pre:!0},[this._v("apply")]),this._v(" 简单（性能更好）。那么我们也尝试用 es5 实现")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("pre",{pre:!0},[t("code",{attrs:{"v-pre":"",class:"language-js"}},[this._v("fn.call(obj, arg1, arg2 ...)\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{attrs:{"v-pre":"",class:"language-js"}},[a("span",{attrs:{class:"hljs-built_in"}},[s._v("Function")]),s._v(".prototype.myCall = "),a("span",{attrs:{class:"hljs-function"}},[a("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" obj = "),a("span",{attrs:{class:"hljs-built_in"}},[s._v("arguments")]),s._v("["),a("span",{attrs:{class:"hljs-number"}},[s._v("0")]),s._v("] || "),a("span",{attrs:{class:"hljs-built_in"}},[s._v("window")]),s._v(";\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" args = [];\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),a("span",{attrs:{class:"hljs-number"}},[s._v("1")]),s._v(";\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("while")]),s._v(" (i < "),a("span",{attrs:{class:"hljs-built_in"}},[s._v("arguments")]),s._v(".length) {\n    args.push("),a("span",{attrs:{class:"hljs-string"}},[s._v("'arguments['")]),s._v(" + i++ + "),a("span",{attrs:{class:"hljs-string"}},[s._v("']'")]),s._v(");\n  }\n  obj.fn = "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(";\n  "),a("span",{attrs:{class:"hljs-comment"}},[s._v("// obj.fn(...Array.prototype.call.slice(arguments, 1))")]),s._v("\n  "),a("span",{attrs:{class:"hljs-comment"}},[s._v("// 这里不能使用 new Function 因为 functionBody 并不会创建上下文闭包")]),s._v("\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" result = "),a("span",{attrs:{class:"hljs-built_in"}},[s._v("eval")]),s._v("("),a("span",{attrs:{class:"hljs-string"}},[s._v("'obj.fn('")]),s._v(" + args + "),a("span",{attrs:{class:"hljs-string"}},[s._v("')'")]),s._v(");\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("delete")]),s._v(" obj.fn;\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" result;\n}\n"),a("span",{attrs:{class:"hljs-comment"}},[s._v("// test")]),s._v("\n"),a("span",{attrs:{class:"hljs-function"}},[a("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{attrs:{class:"hljs-title"}},[s._v("test")]),s._v("("),a("span",{attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n  "),a("span",{attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{attrs:{class:"hljs-built_in"}},[s._v("arguments")]),s._v(");\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(";\n}\n\ntest.call("),a("span",{attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("3")]),s._v(");\ntest.myCall("),a("span",{attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{attrs:{class:"hljs-number"}},[s._v("3")]),s._v(");\n")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("blockquote",[t("p",[this._v("这里还是不严格，一方面是缺乏对调用 call 方法的缺少判断及 fn 覆盖问题，其次是需要注意 apply 第二个参数需要有 length 属性，最后是没有处理 null这种情况。在严格模式下，如果第一个参数为 null， this 指向 null。")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("pre",{pre:!0},[t("code",{attrs:{"v-pre":"",class:"language-js"}},[this._v("arr = arr.concat(oArr);\narr.push.apply(arr, oArr);\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{attrs:{"v-pre":"",class:"language-js"}},[a("span",{attrs:{class:"hljs-built_in"}},[s._v("Function")]),s._v(".prototype.construct = "),a("span",{attrs:{class:"hljs-function"}},[a("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{attrs:{class:"hljs-params"}},[s._v("aArgs")]),s._v(") ")]),s._v("{\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" oNew = "),a("span",{attrs:{class:"hljs-built_in"}},[s._v("Object")]),s._v(".create("),a("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".prototype);\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".apply(oNew, aArgs);\n  "),a("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" oNew;\n};\n")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("a",{attrs:{href:"https://github.com/noneven/__/issues/6"}},[this._v("call和apply的性能对比")]),t("br"),this._v(" "),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function"}},[this._v("使用Function构造器生成的函数，并不会在创建它们的上下文中创建闭包")]),t("br"),this._v(" "),t("a",{attrs:{href:"https://github.com/mqyqingfeng/Blog/issues/11"}},[this._v("JavaScript深入之call和apply的模拟实现")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("b",{staticClass:"show-blog"},[this._v("true")])])}]},n=a("VU/8")(null,l,!1,null,null,null);t.default=n.exports}});
//# sourceMappingURL=15.16a7a43f5ffab8d47892.js.map